{% extends 'base.html.twig' %}

{% block title %}Message !{% endblock %}
{% block javascripts %}
    <script src="{{ asset('js/message_view.js') }}" defer></script>
{% endblock %}

{% block body %}
    <main id="message_view">
        <section id="hero_message_view">
    <h1>Sujet : {{ message.subject ?: '(sans sujet)' }}</h1>
            <p><strong>De :</strong> {{ message.sender.name ?: message.sender.email }}</p>
            <p><strong>√Ä :</strong> {{ message.recipient.name ?: message.recipient.email }}</p>
            <p><strong>Premier envoi :</strong> {{ message.createdAt|date('d/m/Y H:i') }}</p>
        </section>

<section id="content_message_view">
    <h2 class="hidden">Discussion :</h2>
    <div>{{ message.content|raw }}
        <div>
        <p>Pi√®ce(s) jointe(s) :</p>
        <ul>
            {% for file in message.files %}
                <li>
                    <a href="{{ path('secure_file', { id: file.id }) }}">
                        {{ file.originalName ?: file.name }}
                    </a>
                </li>
            {% else %}
                <li>Aucune pi√®ce jointe.</li>
            {% endfor %}
        </ul>
        </div>
    </div>

    {{ form_start(form, {
        attr: {
            class: app.user.name == message.sender.name
            ? 'sender'
            : (app.user.name == message.recipient.name ? 'recipient' : '')
        }
    }) }}

    <div class="file-upload">
        {{ form_row(form.files, {
            attr: {
                class: 'input-fichier-cache'
            },
            label: false
        }) }}

        <label for="answer_form_files" class="label-piece-jointe" title="Ajouter un fichier">
            üñáÔ∏è
        </label>
    </div>
    <div>
        <div>
    {{ form_row(form.reponse) }}
    <button type="submit">‚ñ∂</button>
        </div>
        <div id="file-names" class="file-names"></div>
    </div>

    {{ form_end(form) }}
</section>
    </main>
{% endblock %}
